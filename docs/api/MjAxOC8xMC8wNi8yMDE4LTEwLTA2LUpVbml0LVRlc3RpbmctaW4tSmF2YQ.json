{"title":"JUnit Testing in java","date":"2018-10-06T17:27:12.000Z","date_formatted":{"ll":"Oct 6, 2018","L":"10/06/2018","MM-DD":"10-06"},"link":"2018/10/06/2018-10-06-JUnit-Testing-in-Java","tags":["Java"],"categories":["Programming"],"updated":"2022-03-29T17:25:38.042Z","content":"<p>Using JUint 5 and JDK 8</p>\n<span id=\"more\"></span>\n<h1 id=\"introduction\">Introduction<a title=\"#introduction\" href=\"#introduction\"></a></h1>\n<p>This post will examine testing in the java programming language.  We’ll use an implementation of a graph abstract data type to motivate testing at the unit and behavior levels using java.  A graph is a type of Abstract Data Type (ADT) that allows you to capture and reason about the relationships between objects in your problem.  There are several open source projects that implement a graph as their core data structure, for example: the Neo4J database and the open source Cassandra database.</p>\n<p>The sample code for this article can be found on: ( <a href=\"https://github.com/muguira-james/GraphsTesting_Java\" target=\"_blank\">link to github</a>)</p>\n<h1 id=\"tool-set\">Tool set<a title=\"#tool-set\" href=\"#tool-set\"></a></h1>\n<p>Since this post is going to explore java, let’s state the tool set we’ll use:</p>\n<p>Java 1.8 – openjdk</p>\n<p>Eclipse – any recent version</p>\n<p>JUnit – 5.0.</p>\n<h1 id=\"what-is-a-graph?\">What is a Graph?<a title=\"#what-is-a-graph?\" href=\"#what-is-a-graph?\"></a></h1>\n<p><img src=\"/images/GraphOfPeople.png\" alt=\"GraphOfPeople.png\" loading=\"lazy\" class=\"φbp\"></p>\n<p>A graph is composed of nodes, also called vertices and edges.  A node contains information about characters in our game. In this case, a node contains information like the character name, their relative strength, what they are carrying, etc.  In our diagram: the oval with the name Jasper is a node.  Jasper is carrying a sword.  Another node is Emma.  She is carrying a wand.  You will notice that the nodes also have edges or arrows connecting them.  These edges represent relationships between the characters.</p>\n<h1 id=\"implementation\">Implementation<a title=\"#implementation\" href=\"#implementation\"></a></h1>\n<p>How could we represent these nodes and edges in a graph ADT? Let’s first start with defining a java class for the overall graph and then we can create specialized extensions.  We’ll use a Java abstract class and define the interface that we want the specializations to implement.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">package grandview;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">// an abstract Graph type.</span><br><span class=\"line\">//</span><br><span class=\"line\">// To keep it simple, I’ll allow node and edge labels to be defined with integers.</span><br><span class=\"line\">public abstract class Graph &#123;</span><br><span class=\"line\">s''private int numVertices;</span><br><span class=\"line\">s''private int numEdges;</span><br><span class=\"line\"></span><br><span class=\"line\">s''public Graph() &#123;</span><br><span class=\"line\">s''s''numVertices = 0;</span><br><span class=\"line\">s''s''numEdges = 0;</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''public int getNumVertices() &#123;</span><br><span class=\"line\">s''s''return numVertices;</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''public int getNumEdges() &#123;</span><br><span class=\"line\">s''s''return numEdges;</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">s''public void addVertex() &#123;</span><br><span class=\"line\">s''s''</span><br><span class=\"line\">s''s''implementAddVertex();</span><br><span class=\"line\">s''s''numVertices++ ;</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''public void addEdge(int v, int w) &#123;</span><br><span class=\"line\">s''s''implementAddEdge(v, w);</span><br><span class=\"line\">s''s''numEdges++;</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''public abstract void implementAddVertex();</span><br><span class=\"line\">s''public abstract void implementAddEdge(int v, int w);</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''public abstract List&lt;Integer&gt; getNeighbors(int v);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>The Graph object contains methods for getNumVertices(), getNumEdges(), addVertex() and a constructor.  Graph object implementors must define the abstract methods: implementAddVertex(), implementAddEdge() and getNeighbors().</p>\n<p>To get this going in Eclipse, define a new Java package (in my case called Grandview), and inside of that define a new class called Graph.  There are 2 ways we can implement the relationships in a graph, we can implement the relationships as an adjacency matrix or we can implement then as adjacency lists.  Since this post will cover testing let’s use adjacency lists as our implementation.</p>\n<p>For the case of the node labeled Tom: the adjacency list would contain the node id (‘1’) and a list of each node that Tom has a relationship with (Charlie, node 3, Olivia, node 5, and Ben, node 4).  Notice that I’m only listing relationships that are “out bound” from Tom.</p>\n<p><img src=\"/images/AdjacencyList.png\" alt=\"adjacencyList.png\" loading=\"lazy\" class=\"φbp\"></p>\n<p>The following code implements a concrete instance of a Graph object called GraphAdjList.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">package grandview;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.util.ArrayList;</span><br><span class=\"line\">import java.util.HashMap;</span><br><span class=\"line\">import java.util.List;</span><br><span class=\"line\">import java.util.Map;</span><br><span class=\"line\"></span><br><span class=\"line\">public class GraphAdjList extends Graph &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">s''private Map&lt;Integer, ArrayList&lt;Integer&gt;&gt; adjListMap = </span><br><span class=\"line\">s''s''s''new HashMap&lt;Integer, ArrayList&lt;Integer&gt;&gt;();</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''@Override</span><br><span class=\"line\">s''public void implementAddVertex() &#123;</span><br><span class=\"line\">s''s''// add a new vertex (or node) to the graph</span><br><span class=\"line\">s''s''int v = getNumVertices();</span><br><span class=\"line\">s''s''ArrayList&lt;Integer&gt; neighbors = new ArrayList&lt;Integer&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">s''s''adjListMap.put(v, neighbors);</span><br><span class=\"line\"></span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">s''@Override</span><br><span class=\"line\">s''public void implementAddEdge(int v, int w) &#123;</span><br><span class=\"line\">s''s''// add edge w to node v</span><br><span class=\"line\">s''s''(adjListMap.get(v)).add(w);</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''@Override</span><br><span class=\"line\">s''public List&lt;Integer&gt; getNeighbors(int v) &#123;</span><br><span class=\"line\">s''s''// show the neighbors of the given node</span><br><span class=\"line\">s''s''</span><br><span class=\"line\">s''s''return adjListMap.get(v);</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''s''</span><br><span class=\"line\">s''public void showGraph() &#123;</span><br><span class=\"line\">s''s''System.out.println(&quot;-----------------------&quot;);</span><br><span class=\"line\">s''s''for (int j=0; j&lt;adjListMap.size(); j++) &#123;</span><br><span class=\"line\">s''s''s''</span><br><span class=\"line\">s''s''s''System.out.format(&quot;Vertex num = %d\\n&quot;, j);</span><br><span class=\"line\">s''s''s''</span><br><span class=\"line\">s''s''s''for (Integer it: adjListMap.get(j)) &#123;</span><br><span class=\"line\">s''s''s''s''System.out.format(&quot;\\tconnected to: %d\\n&quot;, it);</span><br><span class=\"line\">s''s''s''&#125;</span><br><span class=\"line\">s''s''s''</span><br><span class=\"line\">s''s''&#125;</span><br><span class=\"line\">s''s''System.out.println(&quot;-----------------------&quot;);</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>You should see the 3 “@Override” statements in the above code.  These are the methods we are required to implement when we extend Graph.</p>\n<h1 id=\"testing\">Testing<a title=\"#testing\" href=\"#testing\"></a></h1>\n<p>Now, we can explore testing using JUnit.  Using Eclipse, select the file GraphAdjList.java and create a new JUnit  Test Case.  Notice that Eclipse will automatically name the file: GraphAdjListTest.java.  Using the defaults we see that Eclipse provided us with a “@Test” method we can fill in.</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">package grandview;</span><br><span class=\"line\"></span><br><span class=\"line\">import static org.junit.jupiter.api.Assertions.*;</span><br><span class=\"line\"></span><br><span class=\"line\">import java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\">import org.junit.jupiter.api.Test;</span><br><span class=\"line\"></span><br><span class=\"line\">class GraphAdjListTest &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">s''@Test</span><br><span class=\"line\">s''void test() &#123;</span><br><span class=\"line\">s''&#125;\t</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>How do we test our code?  One of the nice things about JUnit is that we can define as many different tests as we need.  JUnit provides many more methods that could be used to define a testing framework.  For our example we are only going to use the most basic elements.</p>\n<h1 id=\"handling-an-edge-case\">Handling an Edge case<a title=\"#handling-an-edge-case\" href=\"#handling-an-edge-case\"></a></h1>\n<p>Let’s first see if we can create a new GraphAdjList, add a new vertex and then create the relationship between Jasper and Tom.  For simplicity we’ll just deal with the node IDs.  So we’ll make a node 0 (Jasper) and a node 1 (Tom) and connect them.</p>\n<p>Before we implement the JUnit code to do the test, let’s write out what we are doing in prose. We want to:</p>\n<ul>\n<li>\n<p>Create a GraphAdjList</p>\n</li>\n<li>\n<p>Add a new vertex</p>\n</li>\n<li>\n<p>Add the relationship between Jasper and Tom</p>\n</li>\n<li>\n<p>Check to see if the graph represents this relationship.</p>\n</li>\n</ul>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">@Test</span><br><span class=\"line\">void testBasicRelationship() &#123;</span><br><span class=\"line\">s''GraphAdjList adjList = new GraphAdjList();</span><br><span class=\"line\">s''adjList.addVertex();</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''int numVerts = adjList.getNumVertices();</span><br><span class=\"line\">s''System.out.format(&quot;number of vertices: %d\\n&quot;, numVerts);</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''adjList.addEdge(0, 1);</span><br><span class=\"line\">s''// 1st, check to see if we have the right number of vertices</span><br><span class=\"line\">s''assertEquals(1, numVerts);</span><br><span class=\"line\"></span><br><span class=\"line\">s''// check to see if the right nodes are </span><br><span class=\"line\">s''// represented on each end of the edge</span><br><span class=\"line\">s''List&lt;Integer&gt; lst = adjList.getNeighbors(0);</span><br><span class=\"line\">s''int a = lst.get(0);</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''assertEquals(1, a);</span><br><span class=\"line\">s''// print out our graph</span><br><span class=\"line\">s''adjList.showGraph();</span><br><span class=\"line\">s''</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>Let’s explore what is going on. First, on line 3 and 4 we create a new GraphAdjList and add a vertex to it. On line 9-18 we add the relationship between Jasper, node 0 and Tom, node 1.  Last, we explore the graph to make sure the Jasper to Tom relationship is linked up correctly and print the graph.  To run this test in Eclipse, select your project in the Package Explorer, right click and select ”Run As-&gt;JUnit Test”</p>\n<p>The above test used one of the JUnit test tools: assertEquals.  If you consult the documentation you will see there are many more JUnit tools available. The test we just created tested to see if the following methods on GraphAdjList worked correctly: the constructor, addVertex, addEdge and getNeighbors.  However, not all of the possible cases for each of these calls are tested.  For example, what if we tried to:</p>\n<ul>\n<li>\n<p>add a node with a negative ID?</p>\n</li>\n<li>\n<p>add an edge with a negative ID?</p>\n</li>\n</ul>\n<p>Let’s try and add a node with a negative ID.  Here is the test case:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">@Test</span><br><span class=\"line\">void testNegativeNeighbor() &#123;</span><br><span class=\"line\">s''GraphAdjList al = new GraphAdjList();</span><br><span class=\"line\">s''al.addVertex();</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''// do edge cases:</span><br><span class=\"line\">s''// can I add a vertex with a negative index?</span><br><span class=\"line\">s''al.addEdge(0, 1);</span><br><span class=\"line\">s''al.addVertex();</span><br><span class=\"line\">s''</span><br><span class=\"line\">s''al.addEdge(-1, 2);</span><br><span class=\"line\">s''al.showGraph();</span><br><span class=\"line\">s''</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<p>When we run this code block in eclipse we get errors.  Again, select your project in the Package Explorer, right click and use “Run As-&gt;JUnit Test”.  The JUnit tab opens and shows you “red” and a stack trace:</p>\n<p><img src=\"/images/GraphError.png\" alt=\"GraphError.png\" loading=\"lazy\" class=\"φbp\"></p>\n<p>You can use the stack trace to find what line in the code died.  In this case the test failed on line 52 (GraphAdjListTest.java), but more importantly, the graph code died on line 25 (GraphAdjList.java).  That line is trying to add an edge between node id == -1 and node id == 2.  The HashMap does not let us do this.<br>\nNow, we can refactor the code to handle this case correctly.  First, we need to udate Graph.java to test for illegal arguments and throw exceptions.  Then we can refactor GraphAdjList.java to do the test and throw the exceptions.</p>\n<p>In Graph.java, the addEdge method now looks like this:</p>\n<p>public void addEdge(int v, int w) throws IllegalArgumentException { … }</p>\n<p>In GraphAdjList.java, the implementAddEdge now looks like this:</p>\n<figure class=\"highlight plaintext\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\">@Override</span><br><span class=\"line\">public void implementAddEdge(int v, int w) throws IllegalArgumentException &#123;</span><br><span class=\"line\">s''// add edge w to node v</span><br><span class=\"line\">s''if (v &lt; 0) &#123;</span><br><span class=\"line\">s''s''throw new IllegalArgumentException(&quot;vertex id must be &gt; 0&quot;);</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''if (w &lt; 0) &#123;</span><br><span class=\"line\">s''s''throw new IllegalArgumentException(&quot;neighbor vertex id must be &gt; 0&quot;);</span><br><span class=\"line\">s''&#125;</span><br><span class=\"line\">s''(adjListMap.get(v)).add(w);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>\n<h1 id=\"conclusion\">Conclusion<a title=\"#conclusion\" href=\"#conclusion\"></a></h1>\n<p>Generating unit level test cases is a great way to enable collaboration with in a team.  Modern frameworks for writing code, such as Eclipse, automatically enable running test cases.  Test cases also can provide a way to share information about what a piece of code was meant to do.  This post has only touched on the most simple of JUnit tools.  However, we demonstrated an unhandled edge case and how to refactor the code base to take that edge case into consideration.</p>\n","prev":{"title":"Cucumber Testing in Java","link":"2018/10/09/2018-10-09-A-Cucumber-Testing-in-Java"},"next":{"title":"Creating a basic React map app with Leaflet","link":"2018/09/22/2018-09-22-A-creating-basic-React-app-with-a-leaflet-map"},"plink":"http://muguira-james.github.io/2018/10/06/2018-10-06-JUnit-Testing-in-Java/","toc":[{"id":"introduction","title":"Introduction","index":"1"},{"id":"tool-set","title":"Tool set","index":"2"},{"id":"what-is-a-graph?","title":"What is a Graph?","index":"3"},{"id":"implementation","title":"Implementation","index":"4"},{"id":"testing","title":"Testing","index":"5"},{"id":"handling-an-edge-case","title":"Handling an Edge case","index":"6"},{"id":"conclusion","title":"Conclusion","index":"7"}],"reading_time":"1815 words in 12 min"}